import{h as _,r as l,j as e,P as g,p as E,q as b,e as h,a as F,b as z,f as M,L as f}from"./index-DJIYZ9ez.js";import{H as P,F as U}from"./Footer-Bqylm3V6.js";import{C as u}from"./Card-BBbr7O3u.js";import{C as c}from"./Button-Bq_qZ9kv.js";import"./button-BQEhOtkV.js";var v="Avatar",[B,K]=_(v),[H,j]=B(v),N=l.forwardRef((a,r)=>{const{__scopeAvatar:t,...s}=a,[i,o]=l.useState("idle");return e.jsx(H,{scope:t,imageLoadingStatus:i,onImageLoadingStatusChange:o,children:e.jsx(g.span,{...s,ref:r})})});N.displayName=v;var y="AvatarImage",A=l.forwardRef((a,r)=>{const{__scopeAvatar:t,src:s,onLoadingStatusChange:i=()=>{},...o}=a,d=j(y,t),n=T(s,o.referrerPolicy),m=E(x=>{i(x),d.onImageLoadingStatusChange(x)});return b(()=>{n!=="idle"&&m(n)},[n,m]),n==="loaded"?e.jsx(g.img,{...o,ref:r,src:s}):null});A.displayName=y;var w="AvatarFallback",S=l.forwardRef((a,r)=>{const{__scopeAvatar:t,delayMs:s,...i}=a,o=j(w,t),[d,n]=l.useState(s===void 0);return l.useEffect(()=>{if(s!==void 0){const m=window.setTimeout(()=>n(!0),s);return()=>window.clearTimeout(m)}},[s]),d&&o.imageLoadingStatus!=="loaded"?e.jsx(g.span,{...i,ref:r}):null});S.displayName=w;function T(a,r){const[t,s]=l.useState("idle");return b(()=>{if(!a){s("error");return}let i=!0;const o=new window.Image,d=n=>()=>{i&&s(n)};return s("loading"),o.onload=d("loaded"),o.onerror=d("error"),o.src=a,r&&(o.referrerPolicy=r),()=>{i=!1}},[a,r]),t}var R=N,C=A,D=S;const L=l.forwardRef(({className:a,...r},t)=>e.jsx(R,{ref:t,className:h("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r}));L.displayName=R.displayName;const I=l.forwardRef(({className:a,...r},t)=>e.jsx(C,{ref:t,className:h("aspect-square h-full w-full",a),...r}));I.displayName=C.displayName;const k=l.forwardRef(({className:a,...r},t)=>e.jsx(D,{ref:t,className:h("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r}));k.displayName=D.displayName;const W=()=>{var x;const{userRole:a,hasRole:r,updateRole:t,userMetadata:s,signOut:i,getDashboardPath:o}=F(),{toast:d}=z(),n=M();l.useEffect(()=>{console.log("Dashboard component mounted, current role:",a);const p=o();console.log("Determined dashboard path:",p),p!=="/dashboard"&&(console.log("Redirecting to:",p),n(p,{replace:!0}))},[a,n,o]);const m=async()=>{try{await t("developer"),d({title:"Role Updated",description:"You are now a developer!"}),n("/developer")}catch(p){console.error("Error upgrading to developer role:",p),d({title:"Update Failed",description:"Failed to upgrade to developer role",variant:"destructive"})}};return a!=="user"?(console.log("User role is not 'user', not rendering Dashboard"),null):e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(P,{}),e.jsx("main",{className:"flex-grow pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4 md:px-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Dashboard"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Role: ",e.jsx("span",{className:"font-medium capitalize",children:a})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{children:[e.jsx(I,{src:(s==null?void 0:s.avatar_url)||""}),e.jsx(k,{children:((x=s==null?void 0:s.full_name)==null?void 0:x.charAt(0))||"U"})]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:i,children:"Sign Out"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(u,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"My Account"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your profile and account settings."}),e.jsx(c,{variant:"primary",size:"sm",children:"Account Settings"})]}),e.jsxs(u,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Usage History"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"View your past activities and usage of AI agents."}),e.jsx(c,{variant:"primary",size:"sm",children:"View History"})]}),e.jsxs(u,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Billing"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your payment methods and view invoices."}),e.jsx(c,{variant:"primary",size:"sm",children:"Billing Settings"})]})]}),a==="user"&&e.jsx("div",{className:"mt-8",children:e.jsxs(u,{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-100",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Become a Developer"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Want to create and publish your own AI agents? Upgrade to a developer account!"}),e.jsx(c,{variant:"primary",size:"sm",onClick:m,children:"Upgrade to Developer"})]})}),r(["developer","admin"])&&e.jsx("div",{className:"mt-8",children:e.jsxs(u,{className:"p-6 bg-gradient-to-r from-purple-50 to-pink-50 border-purple-100",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Developer Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your AI agents, view analytics, and track earnings."}),e.jsx(c,{variant:"primary",size:"sm",as:f,to:"/developer",children:"Go to Developer Dashboard"})]})}),r("admin")&&e.jsx("div",{className:"mt-8",children:e.jsxs(u,{className:"p-6 bg-gradient-to-r from-amber-50 to-red-50 border-amber-100",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage users, moderate content, and overview platform analytics."}),e.jsx(c,{variant:"primary",size:"sm",as:f,to:"/admin",children:"Go to Admin Dashboard"})]})})]})}),e.jsx(U,{})]})};export{W as default};
