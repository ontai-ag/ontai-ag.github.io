import{r as l,j as e,h as P,P as g,p as H,q as h,e as b,a as $,b as B,f as V,L as y}from"./index-cuAPMHsf.js";import{H as G,F as T}from"./Footer-B5wvvShY.js";import{C as f}from"./Card-BTF6JEi-.js";import{C as p}from"./Button-CQ7FIN7O.js";import"./button-CsVO_NVs.js";var S={exports:{}},A={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x=l;function O(a,t){return a===t&&(a!==0||1/a===1/t)||a!==a&&t!==t}var q=typeof Object.is=="function"?Object.is:O,W=x.useState,K=x.useEffect,Y=x.useLayoutEffect,J=x.useDebugValue;function Q(a,t){var r=t(),n=W({inst:{value:r,getSnapshot:t}}),o=n[0].inst,s=n[1];return Y(function(){o.value=r,o.getSnapshot=t,v(o)&&s({inst:o})},[a,r,t]),K(function(){return v(o)&&s({inst:o}),a(function(){v(o)&&s({inst:o})})},[a]),J(r),r}function v(a){var t=a.getSnapshot;a=a.value;try{var r=t();return!q(a,r)}catch{return!0}}function X(a,t){return t()}var Z=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?X:Q;A.useSyncExternalStore=x.useSyncExternalStore!==void 0?x.useSyncExternalStore:Z;S.exports=A;var ee=S.exports;function ae(){return ee.useSyncExternalStore(te,()=>!0,()=>!1)}function te(){return()=>{}}var j="Avatar",[re,ue]=P(j),[se,w]=re(j),E=l.forwardRef((a,t)=>{const{__scopeAvatar:r,...n}=a,[o,s]=l.useState("idle");return e.jsx(se,{scope:r,imageLoadingStatus:o,onImageLoadingStatusChange:s,children:e.jsx(g.span,{...n,ref:t})})});E.displayName=j;var L="AvatarImage",R=l.forwardRef((a,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:o=()=>{},...s}=a,u=w(L,r),i=ne(n,s),d=H(m=>{o(m),u.onImageLoadingStatusChange(m)});return h(()=>{i!=="idle"&&d(i)},[i,d]),i==="loaded"?e.jsx(g.img,{...s,ref:t,src:n}):null});R.displayName=L;var C="AvatarFallback",D=l.forwardRef((a,t)=>{const{__scopeAvatar:r,delayMs:n,...o}=a,s=w(C,r),[u,i]=l.useState(n===void 0);return l.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>i(!0),n);return()=>window.clearTimeout(d)}},[n]),u&&s.imageLoadingStatus!=="loaded"?e.jsx(g.span,{...o,ref:t}):null});D.displayName=C;function N(a,t){return a?t?(a.src!==t&&(a.src=t),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ne(a,{referrerPolicy:t,crossOrigin:r}){const n=ae(),o=l.useRef(null),s=n?(o.current||(o.current=new window.Image),o.current):null,[u,i]=l.useState(()=>N(s,a));return h(()=>{i(N(s,a))},[s,a]),h(()=>{const d=M=>()=>{i(M)};if(!s)return;const m=d("loaded"),c=d("error");return s.addEventListener("load",m),s.addEventListener("error",c),t&&(s.referrerPolicy=t),typeof r=="string"&&(s.crossOrigin=r),()=>{s.removeEventListener("load",m),s.removeEventListener("error",c)}},[s,r,t]),u}var I=E,k=R,_=D;const F=l.forwardRef(({className:a,...t},r)=>e.jsx(I,{ref:r,className:b("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t}));F.displayName=I.displayName;const U=l.forwardRef(({className:a,...t},r)=>e.jsx(k,{ref:r,className:b("aspect-square h-full w-full",a),...t}));U.displayName=k.displayName;const z=l.forwardRef(({className:a,...t},r)=>e.jsx(_,{ref:r,className:b("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t}));z.displayName=_.displayName;const me=()=>{var m;const{userRole:a,hasRole:t,updateRole:r,userMetadata:n,signOut:o,getDashboardPath:s}=$(),{toast:u}=B(),i=V();l.useEffect(()=>{console.log("Dashboard component mounted, current role:",a);const c=s();console.log("Determined dashboard path:",c),c!=="/dashboard"&&(console.log("Redirecting to:",c),i(c,{replace:!0}))},[a,i,s]);const d=async()=>{try{await r("developer"),u({title:"Role Updated",description:"You are now a developer!"}),i("/developer")}catch(c){console.error("Error upgrading to developer role:",c),u({title:"Update Failed",description:"Failed to upgrade to developer role",variant:"destructive"})}};return a!=="user"?(console.log("User role is not 'user', not rendering Dashboard"),null):e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(G,{}),e.jsx("main",{className:"flex-grow pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4 md:px-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Dashboard"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Role: ",e.jsx("span",{className:"font-medium capitalize",children:a})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{children:[e.jsx(U,{src:(n==null?void 0:n.avatar_url)||""}),e.jsx(z,{children:((m=n==null?void 0:n.full_name)==null?void 0:m.charAt(0))||"U"})]}),e.jsx(p,{variant:"ghost",size:"sm",onClick:o,children:"Sign Out"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(f,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"My Account"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your profile and account settings."}),e.jsx(p,{variant:"primary",size:"sm",children:"Account Settings"})]}),e.jsxs(f,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Usage History"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"View your past activities and usage of AI agents."}),e.jsx(p,{variant:"primary",size:"sm",children:"View History"})]}),e.jsxs(f,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Billing"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your payment methods and view invoices."}),e.jsx(p,{variant:"primary",size:"sm",children:"Billing Settings"})]})]}),a==="user"&&e.jsx("div",{className:"mt-8",children:e.jsxs(f,{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-100",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Become a Developer"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Want to create and publish your own AI agents? Upgrade to a developer account!"}),e.jsx(p,{variant:"primary",size:"sm",onClick:d,children:"Upgrade to Developer"})]})}),t(["developer","admin"])&&e.jsx("div",{className:"mt-8",children:e.jsxs(f,{className:"p-6 bg-gradient-to-r from-purple-50 to-pink-50 border-purple-100",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Developer Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage your AI agents, view analytics, and track earnings."}),e.jsx(p,{variant:"primary",size:"sm",as:y,to:"/developer",children:"Go to Developer Dashboard"})]})}),t("admin")&&e.jsx("div",{className:"mt-8",children:e.jsxs(f,{className:"p-6 bg-gradient-to-r from-amber-50 to-red-50 border-amber-100",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage users, moderate content, and overview platform analytics."}),e.jsx(p,{variant:"primary",size:"sm",as:y,to:"/admin",children:"Go to Admin Dashboard"})]})})]})}),e.jsx(T,{})]})};export{me as default};
