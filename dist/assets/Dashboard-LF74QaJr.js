import{c as B,a as I,f as q,b as $,r,j as e}from"./index-CPA6k6Ej.js";import{H as J,F as K}from"./Footer-C14Ivnmf.js";import{C as d}from"./Card-BZNk8QFa.js";import{T as Q,a as W,b as S,c,d as X,e as m}from"./table-BrQIh0pP.js";import{B as n}from"./button-BPL5u1sy.js";import{D as E,a as T,b as R,c as P,d as U,e as L}from"./dialog-FIQ-cKoE.js";import{T as Y}from"./textarea-C0uk3nER.js";import{a as f}from"./agentService-DNIFqXhy.js";import{M as Z}from"./message-square-5NvedPC-.js";import{C as ee}from"./circle-alert-D22Ow0Mh.js";import"./Combination-BUvUA-ID.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=B("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=B("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),M={"text-generation":"Text Generation","image-generation":"Image Generation","data-analysis":"Data Analysis","conversational-ai":"Conversational AI","code-generation":"Code Generation",translation:"Translation",other:"Other"},he=()=>{const{userRole:x,isAuthenticated:g,user:te}=I(),N=q(),{toast:i}=$(),[h,j]=r.useState([]),[_,b]=r.useState(!0),[u,O]=r.useState({totalUsers:0,developers:0,activeAgents:0,totalRevenue:0}),[H,o]=r.useState(!1),[V,p]=r.useState(!1),[t,A]=r.useState(null),[y,w]=r.useState("");r.useEffect(()=>{g&&x!=="admin"&&N("/dashboard")},[g,x,N]),r.useEffect(()=>{g&&x==="admin"&&(async()=>{try{b(!0);const a=await f.getAgents({status:"pending"});j(a),await k()}catch(a){console.error("Error fetching pending agents:",a),i({title:"Error",description:"Could not load pending agents. Please try again.",variant:"destructive"})}finally{b(!1)}})()},[g,x,i]);const k=async()=>{try{console.warn("[SUPABASE_REMOVAL] Mocking totalUsers count in AdminDashboard.");const a=0;console.warn("[SUPABASE_REMOVAL] Mocking developers count in AdminDashboard.");const v=(await f.getAgents({status:"approved"})).length;console.warn("[SUPABASE_REMOVAL] Using agentService for activeAgents count in AdminDashboard."),O({totalUsers:0,developers:a||0,activeAgents:v||0,totalRevenue:0})}catch(s){console.error("Error fetching stats:",s)}},z=s=>{A(s),o(!0)},C=s=>{A(s),w(""),p(!0)},D=async s=>{try{if(!await f.updateAgent(s,{status:"approved"}))throw new Error("Failed to update agent status");j(h.filter(l=>l.id!==s)),await k(),i({title:"Agent Approved",description:"The agent has been approved and is now public."}),o(!1)}catch(a){console.error("Error approving agent:",a),i({title:"Error",description:"Could not approve the agent. Please try again.",variant:"destructive"})}},G=async(s,a)=>{try{if(!await f.updateAgent(s,{status:"rejected"}))throw new Error("Failed to update agent status");j(h.filter(v=>v.id!==s)),i({title:"Agent Rejected",description:a?"The agent has been rejected with feedback.":"The agent has been rejected."}),o(!1),p(!1)}catch(l){console.error("Error rejecting agent:",l),i({title:"Error",description:"Could not reject the agent. Please try again.",variant:"destructive"})}};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-background",children:[e.jsx(J,{}),e.jsx("main",{className:"flex-grow pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-foreground",children:"Admin Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(d,{className:"bg-card",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200 mr-4",children:e.jsx(F,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-semibold text-foreground",children:u.totalUsers})]})]})}),e.jsx(d,{className:"bg-card",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-200 mr-4",children:e.jsx(F,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Developers"}),e.jsx("p",{className:"text-2xl font-semibold text-foreground",children:u.developers})]})]})}),e.jsx(d,{className:"bg-card",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-200 mr-4",children:e.jsx(se,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Agents"}),e.jsx("p",{className:"text-2xl font-semibold text-foreground",children:u.activeAgents})]})]})}),e.jsx(d,{className:"bg-card",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-200 mr-4",children:e.jsx(Z,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-semibold text-foreground",children:["$",u.totalRevenue.toFixed(2)]})]})]})})]}),e.jsx(d,{className:"bg-card",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:"Pending Agent Approvals"}),_?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):h.length>0?e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(S,{className:"border-border",children:[e.jsx(c,{className:"text-foreground",children:"Agent Name"}),e.jsx(c,{className:"text-foreground",children:"Category"}),e.jsx(c,{className:"text-foreground",children:"Developer"}),e.jsx(c,{className:"text-foreground",children:"Submitted"}),e.jsx(c,{className:"text-right text-foreground",children:"Actions"})]})}),e.jsx(X,{children:h.map(s=>e.jsxs(S,{className:"border-border",children:[e.jsx(m,{className:"font-medium text-foreground",children:s.name}),e.jsx(m,{className:"text-muted-foreground",children:M[s.category]||s.category}),e.jsx(m,{className:"text-muted-foreground",children:s.developer_name||"N/A"}),e.jsx(m,{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()}),e.jsx(m,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>z(s),children:"View"}),e.jsx(n,{variant:"destructive",size:"sm",onClick:()=>C(s),children:"Reject"}),e.jsx(n,{variant:"default",size:"sm",onClick:()=>D(s.id),children:"Approve"})]})})]},s.id))})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ee,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-foreground",children:"No Pending Agents"}),e.jsx("p",{className:"text-muted-foreground",children:"There are currently no agents awaiting approval."})]})]})})]})}),e.jsx(K,{}),e.jsx(E,{open:H,onOpenChange:o,children:e.jsxs(T,{className:"sm:max-w-[600px] bg-card",children:[e.jsxs(R,{children:[e.jsxs(P,{className:"text-foreground",children:["Agent Details: ",t==null?void 0:t.name]}),e.jsx(U,{className:"text-muted-foreground",children:"Review the details of this agent before taking action."})]}),t&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-right font-medium text-muted-foreground",children:"Name"}),e.jsx("span",{className:"col-span-3 text-foreground",children:t.name})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-right font-medium text-muted-foreground",children:"Category"}),e.jsx("span",{className:"col-span-3 text-foreground",children:M[t.category]||t.category})]}),e.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[e.jsx("span",{className:"text-right font-medium text-muted-foreground pt-1",children:"Description"}),e.jsx("p",{className:"col-span-3 text-foreground text-sm",children:t.description})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-right font-medium text-muted-foreground",children:"Pricing"}),e.jsx("span",{className:"col-span-3 text-foreground capitalize",children:t.pricing_model})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-right font-medium text-muted-foreground",children:"Developer"}),e.jsx("span",{className:"col-span-3 text-foreground",children:t.developer_name||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-right font-medium text-muted-foreground",children:"Submitted"}),e.jsx("span",{className:"col-span-3 text-foreground",children:new Date(t.created_at).toLocaleString()})]})]}),e.jsxs(L,{className:"border-t border-border pt-4",children:[e.jsx(n,{variant:"outline",onClick:()=>o(!1),children:"Close"}),e.jsx(n,{variant:"destructive",onClick:()=>{o(!1),C(t)},children:"Reject"}),e.jsx(n,{variant:"default",onClick:()=>D(t.id),children:"Approve"})]})]})}),e.jsx(E,{open:V,onOpenChange:p,children:e.jsxs(T,{className:"sm:max-w-[425px] bg-card",children:[e.jsxs(R,{children:[e.jsxs(P,{className:"text-foreground",children:["Reject Agent: ",t==null?void 0:t.name]}),e.jsx(U,{className:"text-muted-foreground",children:"Provide feedback to the developer explaining why the agent was rejected."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsx(Y,{placeholder:"Enter rejection feedback here...",value:y,onChange:s=>w(s.target.value),className:"min-h-[100px] bg-input text-foreground border-border"})}),e.jsxs(L,{className:"border-t border-border pt-4",children:[e.jsx(n,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:()=>G(t.id,y),children:"Confirm Rejection"})]})]})})]})};export{he as default};
